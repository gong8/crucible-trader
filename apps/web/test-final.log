
> @crucible-trader/web@0.0.1 test /Users/gong/Programming/Projects/crucible-trader/apps/web
> tsc -p tsconfig.test.json && node --test dist-test/test/api.test.js dist-test/test/new-run-helpers.test.js dist-test/test/date-range.test.js dist-test/test/strategy-controls.test.js dist-test/test/strategy-validation.test.js

✔ apiRoute normalizes paths and uses default base (0.872209ms)
✔ apiRoute respects NEXT_PUBLIC_API_BASE_URL override (0.8265ms)
✔ computeAvailableRange picks tiingo range when available (0.629584ms)
✔ computeAvailableRange aggregates auto range from remote sources (1.194625ms)
✔ computeAvailableRange falls back to csv coverage when remote missing (0.135333ms)
✔ computeAvailableRange returns null when no dataset exists (0.122583ms)
✔ generateRunName slugs strings and lowercases (0.650542ms)
✔ buildDatasetOverride returns undefined when flag or dataset missing (0.097292ms)
✔ buildDatasetOverride maps dataset fields when provided (1.4355ms)
✔ buildDatasetOverride falls back to current date when dataset is missing range (0.130083ms)
✔ buildRequestSafely returns a fully typed BacktestRequest (1.226208ms)
✔ buildRequestSafely omits metrics when list is empty (0.128ms)
✔ buildRequestSafely surfaces strategy validation errors (0.390083ms)
✔ buildRequestSafely handles optional seed and numeric coercion (0.106167ms)
✔ buildRequestSafely surfaces errors for missing run name (0.08175ms)
✔ buildRequestSafely requires non-empty symbol (0.105875ms)
✔ buildRequestSafely validates timeframe values (0.071334ms)
✔ buildRequestSafely validates date format and ordering (0.077708ms)
✔ buildRequestSafely rejects negative or invalid numeric fields (0.083583ms)
✔ buildRequestSafely applies dataset override when present (0.106584ms)
✔ buildRequestSafely validates dataset override contents (0.060542ms)
✔ mapZodIssues maps field errors to a lookup object (0.78825ms)
✔ StrategyControls renders inputs with expected defaults (45.375541ms)
✔ StrategyControls surfaces field errors next to the input (3.010375ms)
✔ validates a minimal valid strategy (1.5535ms)
✔ validates a complete valid strategy with all fields (0.737125ms)
✔ validates strategy with configSchema (0.109916ms)
✔ rejects empty code (0.077875ms)
✔ rejects whitespace-only code (0.753292ms)
✔ rejects strategy missing metadata export (0.115542ms)
✔ rejects strategy missing createStrategy export (0.073292ms)
✔ rejects strategy missing both exports (0.901209ms)
✔ rejects metadata missing name field (0.124375ms)
✔ rejects metadata missing description field (0.158292ms)
✔ rejects metadata with empty name (0.086459ms)
✔ rejects metadata with empty description (0.07375ms)
✔ rejects metadata with name too long (0.087541ms)
✔ warns about short description (0.06025ms)
✔ warns about invalid version format (0.098916ms)
✔ rejects createStrategy missing onBar method (0.062958ms)
✔ rejects createStrategy missing return statement (0.052625ms)
✔ warns about missing lifecycle methods (0.071ms)
✔ warns about missing config parameter (0.065792ms)
✔ warns about empty configSchema (0.058667ms)
✔ rejects configSchema field missing type (0.060209ms)
✔ rejects configSchema field missing label (0.058125ms)
✔ rejects configSchema field missing default (0.065583ms)
✔ rejects configSchema field with invalid type (0.057291ms)
✔ rejects configSchema field with min >= max (0.057875ms)
✔ warns about min/max on non-number field (0.052459ms)
✔ rejects code with unmatched braces (0.046417ms)
✔ rejects code with unmatched parentheses (0.048709ms)
✔ rejects code with unmatched brackets (0.049458ms)
✔ rejects code with eval() (0.049041ms)
✔ rejects code with Function constructor (0.057709ms)
✔ warns about file system access (0.053083ms)
✔ warns about network access (0.049958ms)
✔ warns about process access (0.051542ms)
✔ warns about strategy name mismatch (0.140916ms)
✔ does not warn when strategy names match (0.099125ms)
✔ formatValidationResults formats errors correctly (0.1255ms)
✔ formatValidationResults formats warnings correctly (0.049958ms)
✔ handles multiple errors correctly (0.03725ms)
✔ validates strategy with multiline strings (0.037375ms)
✔ validates strategy with complex nested structures (0.044125ms)
✔ validates strategy with comments (0.043875ms)
ℹ tests 66
ℹ suites 0
ℹ pass 66
ℹ fail 0
ℹ cancelled 0
ℹ skipped 0
ℹ todo 0
ℹ duration_ms 424.689459
